
# 空间数据误差处理

## 课程
- 课时28+8

## 授课目标
- 测量误差性质
- 方差-协方差传播率
- 权与定权
- 最小二乘法原理
- 经典平差方法
- 可视化点位精度评定

## 教学目标
- 误差特性和传播定律
- 掌握最小二乘法原理再空间数据处理中的应用
- 经典测量平差原理和方法
  - 间接平差
  - 条件平差
  - 附有参数的条件平差 
- 使用计算机语言辅助实现经典平差的实际应用

## 与研究生考试的关系

- 测绘科学与技术
  - 大地测量学与测量工程
  - 摄影测量与遥感
  - 地图制图学与地理信息系统工程
  - 测绘工程（专硕）

## 作用与地位
* 解决测量工作中的实际问题，对测量数据机型处理，犰虎最佳估值，评价数据的质量（精确度）。
* 是测绘学科的基础理论，是对仪器操作和基本测量方法的主要补充。
* 课程基础
* 开展科学研究的重要手段与方法

## 参考书目
+ 测量平差，张书毕，中国矿业大学
+ 误差理论与测量平差基础，武汉大学出版社
+ 误差理论与测量平差基础习题集，武汉大学出版社
+ 概率论、线性代数、微积分等数数学课本

## 线上资源
+ 学习通
+ i163，mooc，误差理论与测量平差基础

## 学习建议
+ 课前预习（线上资源+课本）
+ 课后复习+作业练习+答疑



## 引例1——条件极值
**条件极值如何求取**

条件极值函数：
$$
\left \{
\begin{aligned}
f=x_1^2+\frac{1}{2}x_2^2+\frac{1}{3}x_3^2
\end{aligned}
\right .
$$

约束条件1：
$$
\left \{
\begin{aligned}
x_1^2+x_2^2+x_3^2=1
\end{aligned}
\right .
$$

约束条件2：
$$
\left \{
\begin{aligned}
x_1+x_2=-22\\
-x_2+x_3=10
\end{aligned}
\right .
$$

## 引例2——测量学
从多个控制点引导线到待测点，得到坐标（高程）不同，如何处理？
- 检查超限问题，重测
- 加权平均，由路线长度、测站数量作为权重

## 引例3——大地测量学

平面坐标转换
$$
\begin{bmatrix}X\\Y
\end{bmatrix}
=
\begin{bmatrix}X_0\\Y_0
\end{bmatrix}
+(1+m)
\begin{bmatrix} \cos{\alpha}&-\sin{\alpha}\\\sin{\alpha}&\cos{\alpha}
\end{bmatrix}
\begin{bmatrix}x\\y
\end{bmatrix}
$$

三维坐标转换（七参数法）:3个点,9个方程

$$
\begin{bmatrix}X_2\\Y_2\\Z_2
\end{bmatrix}
=
\begin{bmatrix}X_0\\Y_0\\Z_0
\end{bmatrix}
+(1+m)
\begin{bmatrix}X_1\\Y_1\\Z_1
\end{bmatrix}
+
\begin{bmatrix}0&\varepsilon_Z&-\varepsilon_Y\\-\varepsilon_Z&0&\varepsilon_X\\\varepsilon_Y&-\varepsilon_X& 0\\
\end{bmatrix}
\begin{bmatrix}X_1\\Y_1\\Z_1
\end{bmatrix}
$$

高程异常拟合（大地高->正常高）
$$
\zeta=a_0+a_1x+a_2y+a_3x^2+a_4y^2+a_5xy
$$

## 引例4——其他课程
摄影测量——光束法平差

卫星导航定位——单点定位、相对定位

地理信息系统——地图集合纠正（2维/3维相似变换）

## 目录
- Chapter 0 前言——2
- Chapter 1 测量误差及其传播定律——3
- Chapter 3 平差数学模型与最小二乘原理——2
- Chapter 4 条件平差——5
- Chapter 5 间接平差——6
- Chapter 6 概括平差——4
- Chapter 7 误差椭圆——2
- Chapter 8 编程基础及实验——8


## 测量平差基本概念
### 测量条件与测量误差
测量是`观测者`在特定`环境`中借助`仪器`获取`测量对象`物理（几何）信息的活动。

测量条件=观测者+仪器+测量环境+测量对象

结论：测量条件不可能尽善尽美，必有`测量误差`。

`测量误差`：<u>观测值与其客观真实值之差。</u>

**测量条件**
+ 观测者：鉴别力、工作态度、水平差别
+ 仪器：精密度、读盘刻划、轴向误差
+ 测量环境:圆筒、标尺
+ 测量对象：

测量条件好，测量精度高。

**等精度观测**

**多余观测**：
- 必要观测以外的观测。
- 作用：
  - 发现观测误差
  - 提高观测结果的精度

**必要观测**：测量中可确定全部未知量所需的<u>最少</u>的观测（必需观测）。

eg.三角形内角观测

**最小二乘原理（the Least Squares Principle）**

等精度观测：改正数平方相加最小

精度不相等：加权

**测量平差（Adjustment of Observation）**
在`多余观测`基础上，依据一定的观`测模型`，按照`一定的数学法则`，对观测结果进行合理的调整，求得一组没有矛盾的`最可靠结果`，并`评定精度`，这种处理方法和过程称为测量平差。

与平差有关的两个词：

**最或然值**：用最小二乘平差求得的未知数的解，也叫最可靠值，平差值。

**最或然改正数**：最小二乘平差计算的观测值改正数，也叫残差，改正数。


L:观测

$\hat{X}$ 平差

V 最后得到的输出

$$
V=\hat{X}-L
$$

## 测量平差的任务
1. 由最小二乘法求带定量的平差值（参数估计）
2. 估计观测结果和平差结果的精度（精度评定）

**研究对象**
1. 偶然误差
2. 系统误差
3. 粗差
4. 带有偶然误差的观测值

## 测量平差发展简史
古老而又充满活力的
### 产生背景
多于未知参数的观测值集合求出未知数的最佳估值

### 经典最小二乘法
高斯，概论统计角度提出最小二乘

## 课程内容
- 误差理论 chapter 1
- 测量平差方法 chapter 2-5
- 误差椭圆 chapter 6
- 编程基础
- 编程补充

## 数学补充知识
### 矩阵
- 由m*x个数有次序排列
- m=n 方阵
- 元素全0，称为零矩阵，用O
- 对角阵
- 单位阵
- 对称矩阵

### 矩阵基本运算
- 矩阵相等
- 矩阵加减
- 矩阵相乘

### 矩阵转置
行列互换

转置矩阵的性质

### 矩阵的逆
+ 给定一个n阶方阵A，若存在一个同阶方阵B，使$AB=BA=I(E)$，则称B为A的逆矩阵，记为$B=A^{-1}$

+ A矩阵存在逆矩阵的充分必要条件是A的行列式不等于0,称A为非奇异矩阵，否则为奇异矩阵。

+ 矩阵的逆的性质：
$$
\begin{aligned}
&(AB)^{-1}=B^{-1}A^{-1}\\
&(A^{-1})^{-1}=A\\
&(I)^{-1}=I\\
&(A^T)^{-1}=(A^{-1})^T\\
&对称矩阵的逆仍然是对称矩阵。\\
&对角矩阵的逆仍然是对角矩阵且：\\
&A^{-1}=(diag(a_{11},a_{22},\cdots a_{nn}))^{-1}\\
&=diag(\frac{1}{a_{11}},\frac{1}{a_{22}}\cdots \frac{1}{a_{nn}})\\
\end{aligned}
$$

+ 矩阵求逆方法：
代数余子式：
设$A_{ij}$为A的第i行j列元素$a_{ij}$的代数余子式，则由n*n个代数余子式构成的矩阵为A的伴随矩阵的转置矩阵A^*称为A的伴随矩阵。

$$
A^*=\begin{bmatrix}
A_{11}&A_{21}&\cdots &A_{n1}\\
A_{12}&A_{22}&\cdots &A_{n2}\\
\cdots &\cdots &\cdots &\cdots \\
A_{1n}&A_{2n}&\cdots &A_{nn}\\
\end{bmatrix},A^{-1}=\frac{1}{\lvert A \rvert}A^*
$$

（$A^*$是A的伴随矩阵）

二阶矩阵 
$$A=\begin{bmatrix}a&b\\c&d\end{bmatrix}$$
的逆
$$A^{-1}=\frac{1}{ad-bc}\begin{bmatrix}d&-b\\-c&a\end{bmatrix}$$