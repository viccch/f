---
layout: post
title: "GNSS-Chapter 5 Satellite Orbits"
categories: gnss
date:   2022-10-13 00:07:43 +0800
---


# Chapter 5 Satellite Orbits

# 卫星运动和卫星位置计算

## 主要内容
- [一、导航电文的概念与结构](#sect1)
- [二、计算GPS卫星位置的思路](#sect2)
- [三、BDS导航电文与卫星坐标](#sect3)
- [四、课程小结与思考](#sect4)

## 一、导航电文的概念与结构

<span id="sect1"></span>

**导航电文的基本概念**
包括卫星星历、时钟改正、电离层改正、卫星工作状态信息，以及C/A码转换到捕捉P码的信息。

在全球卫星导航系统中，导航电文以二进制码的形式，通过模二和方法调制到L波段进行播发。

导航电文是用户用来定位和导航的数据基础。

**GPS卫星导航电文的结构**

1个主帧：共1500bit，传输速率50bit/s
1个子帧：共300bit
1个子码：共30bit
1个页面：第4、5子帧共35500bit

更新频率：第1、2、3子帧每小时更新一次
第4、5子帧仅在注入新导航数据后才更新

遥测码：用来表明卫星注入数据的状态。

1-8bit：同步码，解释导航电文
9-22bit：遥测电文，包括地面监控注入数据时的状态信息、诊断信息和其他信息。
23、24bit：遥测电文，包括地面监控注入数据时的状态信息、诊断信息和其他信息。
25-30bit：就检验码，用于发现和纠正错误。

转换码：时间计数，颗据此将接收机时钟域GPS时精准对齐，进而宝珠用户从所捕获的C/A码转到捕获P码。

第一数据块：
时延差改正
数据龄期
星期序号
卫星时钟改正

第二数据块：
开普勒六参数 $\sqrt{\alpha}、e、i_0、\Omega_0、\omega、M_0$
轨道摄动九参数
时间二参数（星历参考时刻、星历表的数据龄期）

第三数据块：
第四子帧，第五子帧。

## 二、计算GPS卫星位置的思路
<span id="sect2"></span>

**基本思路**
- 首先计算卫星在轨道平面坐标系下的坐标。
- 然后将上述坐标分别绕X轴旋转-i角，绕Z轴旋转$-\Omega_k$角，求出卫星在地固坐标系下的坐标。

## 三、BDS导航电文与卫星坐标
<span id="sect3"></span>


### DBS导航电文
27颗MEO卫星（中圆地球轨道）

3颗IGSO卫星（倾斜地球同步轨道）

给出：D1导航电文
基本导航信息
- 本卫星基本导航信息
- 全部卫星历书信息
- 与其他系统时间同步信息
（与GPS导航电文基本类似！）

5颗GEO卫星（地球静止轨道）

给出：D2导航电文
基本导航信息和增强服务信息
- 北斗系统的差分及完好性信息
- 格网点电离层信息
（北斗独有）


### BDS卫星位置计算
首先计算卫星在轨道平面坐标系下的坐标
然后计算其在CGCS2000地固坐标系中的空间直角坐标。


## 四、课程小结与思考
<span id="sect4"></span>

1.导航电文的概念与结构
遥测码，转换码，第一二三数据块
2.计算GPS卫星位置的思路
先轨道平面，再地固系
3.BDS导航电文与卫星坐标
三种轨道，两种导航电文，星基增强服务，GEO卫星坐标计算。


## 思考题 
如下是从北斗卫星星历文件中的部分观测结果，请结合本节课内容和教材66页相关公式，计算该卫星的再此刻的位置坐标。




---

# Chapter 3 Satellite Orbits

# 卫星运动与卫星位置计算

# 主要内容

3.1 二体问题
3.2 开普勒定律
3.3 开普勒轨道参数
3.4 卫星的无摄运动
3.5 卫星的受摄运动
3.6 卫星位置计算

卫星轨道基本概念

轨道：卫星再空间按运行的轨迹
轨道参数：描述卫星轨道位置和状态的参数，称为轨道参数

卫星所受作用力的分类

中心引力：假设地球为匀质球体的引力，即地球对卫星的引力，称为中心引力。

摄动力：非球形堆成的地球引力场对卫星产生非中心的引力，再加上日月引力，大气阻力，太阳光压，地球潮汐力等一起称为摄动力。假设地球引力场的影响为1，则其他作用力的影响比之均小于$10^{-5}$。

二体问题 
忽略所有摄动力，仅考虑中心引力对卫星的作用，来研究卫星相对于地球的运动。

研究卫星运动的基本思想
- 首先研究二体问题
- 在此基础上，再加上摄动力的影响。即可推导出卫星受摄运动的轨道。
- 通过研究卫星的无摄运动和受摄运动，颗确定任意时刻卫星运动的轨道参数，进而根据轨道参数可以求得卫星的位置和速度。

卫星的无摄运动
卫星的质量$m_s$相对于地球质量M可以忽略，于是其引力加速度为：
$$\ddot{r}=-\frac{GM}{\overline{r}^3}\overline{r}$$
引力加速度决定着卫星绕地球运动的基本规律。卫星在上述地球引力场中的无摄运动也称为开普勒运动，其规律可通过开普勒定律表达。


开普勒定律

第一定律：卫星的轨道是一个椭圆，椭圆的一个焦点与地球的质心重合，又称为轨道定律。

第二定律：卫星的地心向径，即地球质心与卫星质心间的距离向量，在相同时间内扫过的面积相等。又称为面积定律。

第三定律：卫星运动周期的平方与轨道椭圆长半径的立方之比为一个常量，等于地球引力常数GM的倒数。称为调和定律。数学形式: $\frac{T _s^2}{a _s^3}=\frac{4^2}{GM}$ 其中$T_s$是卫星运行周期；
$GM=(3986005\pm0.6)\times 10^8(m^3/s^2)$

显然，当开普勒椭圆的长半径确定后，卫星运行的平均角速度便随之确定，且保持不变。

开普勒轨道参数

在二体问题研究中，常用$a,e,V,\Omega,i,\omega$等6个参数描述卫星的无摄运动，称为开普勒轨道参数。

$a$：轨道长半轴
$e$：轨道偏心率
以上两个参数确定了开普勒椭圆的形状和大小。

$\Omega$：升交点赤经，即地球赤道面上升焦点与春分点之间的地心夹角。

$i$：轨道面倾角。
表达了开普勒椭圆在轨道平面上的定向。

$V$：卫星的真近点角，即轨道平面上卫星与近地点之间的地心角距。
该参数是时间的函数，确定卫星在轨道上的瞬时位置。

卫星的实际运行轨道，由于受多种非地球中心引力的影响，而使其偏离开普勒轨道。对于GPS卫星来说，仅地球的非球性影响，在3小时的弧段上就可能使卫星的
位置偏差达2km，而在两日弧段上达14km。显然，这种偏差对于任何用途的导航定位工作，都是不容忽视的。
为此，必须建立各种摄动力模型，对卫星轨道加以修正，以满足精密定轨的要求。

3.5 卫星的受摄运动
卫星在运行中，除了要受到地球中心引力Fc的作用外，还将受到以下各种摄动力的影响，从而引起轨道的摄动：
① 地球体的非球形及其质量分布不均匀而引起的作用力，即地球的非中心引力Fnc；
② 太阳的引力Fs和月球的引力Fn；
③ 太阳的直接与间接辐射压力Fr；
④ 大气的阻力Fa；
⑤ 地球潮汐的作用力；
⑥ 磁力等。

影响：
- 地球引力场摄动力：
  - 引起轨道平面在空间旋转。
  - 引起近地点在轨道平面内旋转。
  - 引起平近点角Ms的变化。
- 日月引力
  - 长周期的。
  - 加速度5*1e-6 N/m。
  - 3小时产生50~150m误差。
  - 太阳引力影响是月球引力影响的0.46倍。
- 太阳光压
  - 直接太阳光辐射压力、地球反射太阳光间接辐射压力。
  - 摄动加速度1e-7 m/s2量级
  - 3小时5~10m偏差
- 地球潮汐
  - 固体潮和海潮。
  - 5天影响可达1m


3.6 卫星位置计算

星历：描述有关卫星运行轨道的信息。

利用GNSS进行导航和定位，就是根据已知的卫星轨道信息和用户观测资料，通过数据处理来确定接收机的位置及其载体的航行速度。所以，精确的轨道信息是精密导航定位的基础。

卫星星历的提供方式，一般有两种：
- 预报星历(广播星历)
- 后处理星历（精密星历)


广播星历：卫星发播的无线电信号上载有的预报一定时间内卫星开普勒轨道参数的电文信息。

GPS用户通过卫星广播星历，可以获得的有关卫星星历参数共有17个，其中包括2个时间参数、6个相应参考时刻的开普勒轨道参数和9个反映摄动力影响的参数。根据上述数据，便可外推出观测时刻 t 的轨道参数，以计算卫星在不同参考系中的相应坐标。

RINEX格式文件命名规则:
（WS672420.03N， WS672420.03O ）
① 测站名（4个字符）：WS67
② 年积日（三位数字）：242
③ 日时段序号（1个字符）：0
④ 年份（两位数）：03
⑤ 文件类型（一个字符）：
N——星历文件
O——观测值文件


Rinex导航文件说明
注：表中X表示空格，A表示字符型，I为整型，F为单精度
浮点型，D为双精度浮点型。
例如，F9.2，11X，A1分别表示宽度为9位，小数点后有两位
的单精度浮点数，11个空格，宽度为1的字符串。


精密星历

精密星历是由IGS（International GNSS Service）通过全球数据的事后处理免费给全球用户提供的更高精度的星历，因此又称为后处理星历，其格式为SP3格式。

目前精密星历的精度可以达到1-2cm



# Chapter 5 Satellite Orbits

# Questions 

What are the main contents of Newton's three laws?

How to determine the orbital plane of satellite motion?

How to describe the satellite position in the ellipse?

How to describe the sate vector of satellite ?

How to determine disturbed orbit of satellite motion?

How to alculate the satellite orbit using broadcast eph.?

Hot to product broadcast eph. based on the position, velocity,clock error information?

How to calculate the satellite orbit using precise eph.?

What are the differences between broadcast and precise ephemerides?

What are the characters of GLONASS broadcast eph.?

