---
layout: post
title: 遥感原理与应用 chapter 5 遥感图像预处理
---
- [chapter 5 遥感图像预处理](#chapter-5-遥感图像预处理)
  - [5.1 几何校正](#51-几何校正)
    - [一、遥感图像的几何变形](#一遥感图像的几何变形)
    - [二、遥感图像的几何校正](#二遥感图像的几何校正)
    - [三、遥感图像的裁剪与镶嵌](#三遥感图像的裁剪与镶嵌)
  - [5.2 辐射矫正](#52-辐射矫正)
    - [误差来源](#误差来源)
    - [校正](#校正)
  - [5.3 图像增强与变换](#53-图像增强与变换)
    - [对比度增强](#对比度增强)
    - [波段间代数运算](#波段间代数运算)
    - [滤波](#滤波)
    - [彩色增强](#彩色增强)
    - [图像变换](#图像变换)

# chapter 5 遥感图像预处理

## 5.1 几何校正

### 一、遥感图像的几何变形

`几何形变`：遥感图像上各地物的位置、形状、尺寸、方位等特征与其在参照系统中的表达要求不一致时，即说明遥感图像发生了几何形变。

遥感图像的总体变形（相对于地面真是形态而言）是平移、缩放、旋转、偏扭、弯曲及其他变形综合作用的结果。


变形误差可分为：
- 静态误差：在成像过程中，传感器相对于地球表面呈静止状态时所具有的各种变形误差。
- 动态误差：在成像过程中由于地球的旋转等因素所造成的图像变形误差。


变形误差也可分为：
- 系统性内部误差：由于传感器自身的性能技术指标偏离标称数值造成的。可事先通过检校测定。例如扫描镜的结构方式和扫描速度等造成的畸变。
- 随机性外部误差：传感器本身处在正常工作的条件下，由其他各种因素造成的误差，其大小不能事先预测、出现带有随机性质。例如地形起伏造成的随地而异的几何偏差。

传感器背身引起的几何变形与遥感器的结构、特性和工作方式而异。这些因素主要包括：
- 1）透镜的辐射方向畸变像差；
- 2）透镜的切线方向畸变像差；
- 3）透镜的焦距误差；
- 4）透镜的光轴与投影面不正交；
- 5）图像的投影面非平面；
- 6）探测元件排列不整齐；
- 7）采样速率的变化；
- 8）采样时刻的偏差;
- 9）扫描镜的扫描速度变化 。


传感器一般的几何成像方式包括：中心投影、全景投影、斜距投影、平行投影。

其中，平坦地区竖直摄影的中心投影和平行投影是没有几何形态变形的，因为中心投影图像本身与地面景物保持相似的关系。

全景投影和斜距投影的结果，则产生图像几何变形。

通常把竖直摄影的中心投影和平行投影（正射投影）的图像作为基准图像，而全景投影和斜距投影变形规律可以通过与中心投影或正射投影的影像比较而获得。


全景投影变形：指全景摄影机的像距不变，物距随扫描角增大而增大，由此所产生影像由中心到两边比例尺逐渐缩小的畸变。全景投影的影像面不是一个平面，而是一个圆柱面。


1）遥感平台位置和运动状态变化的影响
2）地形起伏的影响
3）地球表面曲率的影响
4）大气折射的影响
5）地球自转的影响


### 二、遥感图像的几何校正

几何校正（几何纠正）：校正多种因素引起的遥感图像变形，从而使之实现与标准图像或地图的几何整合。

数字图像的几何校正：通过计算机对离散结构的数字图像中的每一个像元逐个进行校正处理的方法。这种方法能够精确地改正动态扫描图像的误差。

基本原理：利用图像坐标和地面坐标（另一图像坐标、地图坐标等）之间的数学关系，即输入图像和输出图像间的坐标转换关系实现。


几何粗校正：针对引起畸变原因而进行的校正，这种畸变按照比较简单和相对固定的几何关系分布在图像中的，校正时需将传感器原校准数据、遥感平台的位置以及卫星运行姿态等一系列测量数据代入理论校正公式即可。

几何粗校正主要校正系统性内部误差。校正后图像仍存在几何变形。


几何精校正：是利用地面控制点(GCP)进行的几何校正。它用一种数学模型来近似描述遥感图像的几何畸变过程，并利用畸变的遥感图像与标准地图之间的一些对应点（即控制点）求得这个几何畸变模型，然后利用此模型进行几何畸变校正。

这种校正不考虑畸变的具体形成原因，而只考虑如何利用畸变模型来校正遥感图像。

图像配准：采用基准（参考）图像对待校正图像进行的校正。

图像校正：借助地面控制点对待校正图像进行地理坐标的校正。

图像地理编码：把图像校正到统一标准的坐标系。

图像正射投影校正：借助数字高程模型（DEM）进行地形变形的校正，使图像符合正射投影的要求。


遥感图像几何精校正的主要过程；

地面控制点选取 -> 多项式校正模型 -> 坐标变换 -> 灰度重采样 -> 校正精度评价

地面控制点选取：
地面控制点是几何校正中用来建立校正模型的基础。
根据图像特征和实地情况，结合野外调查、地形图、高精度的遥感图像等选择地面控制点。
地面控制点与相应像元为同名地物点，简称同名点。

地面控制点应具备的特征：
在图像上有明显、清晰的定位识别标志，如道路交叉点、建筑边界；
地物不随时间变化；
在未经过地形校正的图像上选取控制点时，应在同一地形高度上进行。


多项式校正模型：

通过多项式函数描述地面控制点在待校正图像上的图像坐标(x,y)与其真实地理坐标(X,Y)的映射关系。


灰度重采样：

若校正后图像像元在原图像上的图像坐标并非整数，则需根据原始图像相邻像元的值生成新的像元值，该过程称为灰度重采样。

重采样方法：

**最近邻域法**
- 距离实际位置最近的像元的灰度值作为输出图像像元的灰度值。
- 方法简单易用，计算量小，能较好地保持原像元值。
- 最大会造成0.5个像元的位置偏移，并使图像中的一些地物的像元值不连续，边界出现锯齿状。

**双线性内插法**：
- 使用邻近4个像元的像元值，按照其距内插点的距离赋予不同的权重，进行先行内插。
- $g(m,n)=\frac{p_1g_1+p_2g_2+p_3g_3+p_4g_4}{p_1+p_2+p_3+p_4}=\frac{\sum_{i-1}^4p_ig_i}{\sum_{i-1}^4p_i}$ 式中，g(m,n)为输出像元灰度值；gi 为邻近点i的灰度值;pi 为邻近点对投影点的权重(pi=1/di, di 表示邻近点到投影点的距离，最近者权重最大)
- 特点：
  - 对像元值不连续现象有明显改善；
  - 计算量增加，有平滑效果，使对比度明显的分界线变得模糊，丧失细节；
  - 破坏了原图像的像元值。

**三次卷积内插法**
- 使用邻近16个像元的像素值，对其赋予不同的权重进行内插，增加邻近点以获得更好地插值精度。
- $g(m,n)=\frac{\sum_{i=1}^{16}p_ig_i}{\sum_{i-1}^{16}p_i}$
  - g(m,n)为输出像元灰度值；
  - gi 为邻近点i的灰度值；
  - pi 为邻近点对投影点的权重(pi=1/di, di 表示邻近点到投影点的距离，最近者权重最大)；
- 特点：
  - 对边缘有所增强，并且具有均衡化和清晰化的效果；
  - 计算量较大；
  - 破坏了原图像的像元值。




### 三、遥感图像的裁剪与镶嵌
图像裁剪的目的是获取选定的影像范围区域。图像裁切工具提供像素范围裁切、文件裁切、几何图元裁剪和指定区域裁切四种方式。像素范围裁切是基于像素坐标获取矩形裁切区域的裁切方式；文件裁剪可以基于矢量文件或者栅格文件地理坐标获取任意形状裁切区域的裁切方式；几何图元裁切是基于交互方式在主视图上绘制多边形来获取裁切范围的裁切方式；指定区域裁切是以指定的点为中心，再以指定的长和宽为步长形成一个矩形裁剪区域进行裁剪的方式。


## 5.2 辐射矫正

### 误差来源

遥感图像受到的辐射误差来源：
  1. 传感器造成的辐射误差
  2. 大气造成的辐射误差
  3. 地形条件造成的辐射误差
  4. 光照条件造成的辐射误差


主要来源于**大气对电磁波的散射和吸收**。

地形的影响：凸起的地形会遮挡太阳的直射光，形成阴影，大幅度减弱传感器接收的辐射能量。


地形的影响：凸起的地形会遮挡太阳的直射光，形成阴影，大幅度减弱传感器接收的辐射能量。


### 校正

针对各种辐射误差进行校正，消除遥感图像中包含的各种辐射失真，使得遥感图像尽可能准确地反映地物目标辐射出的电磁波信号。

DN值（Digital Number）：遥感影像像元亮度值，记录地物的灰度值。无单位，是一个整数值，值的大小与传感器的辐射分辨率、地物反射率、地物发射率、大气透过率和散射率等相关。


地表反射率：地面反射辐射量与入射辐射量之比，表征地面对太阳辐射的吸收和反射能力。反射率越大，地面吸收太阳辐射越少；反射率越小，地面吸收太阳辐射越多


表观反射率：就是指大气层顶的反射率，辐射定标的结果之一，大气层顶表观反射率，简称表观反射率，又称视反射率。

**传感器校正——辐射定标**

传感器校正主要通过**传感器辐射定标**实现。

辐射定标包括：相对辐射定标和绝对辐射定标相对辐射定标

• 又称为传感器探测元件归一化，是为了校正传感器中各个探测元件响应差异而对传感器测量到的原始亮度值进行归一化的过程。

• 由于传感器中各个探测元件之间存在差异，使图像出现条带，相对定标就是降低或消除这些影响。

辐射定标是遥感定量化研究的重要前提。


**大气校正——物理模型**

6s模型

FLAASH模型


**大气校正——统计模型**

暗目标像元法

地面线性回归法


**地形和高度角的校正**

地形校正：


太阳高度角校正


**要点回顾**

大气程辐射是太阳辐射在大气传输过程中各组分及气溶胶微粒散射后直接到达传感器的辐射

大气程辐射叠加在地面反射的电磁波上，是与地面无关的大气干扰，降低了对比度，属背景噪声，是需要修正的重要内容。


大气校正

就是将表观反射率转换为地表实际反射率，目的是消除大气散射、吸收、反射引起的误差。

暗目标

反射率很低的地物被称为暗目标，此时遥感器接收的辐射主要来自于大气的程辐射。


遥感图像镶嵌

遥感图像镶嵌，将多幅图像连接合并，生成一幅完整包含感兴趣区域的图像。


几何精校正中重采样常用方法？

最近邻域法、双线性内插法、三次卷积法


数字图像几何纠正的两个基本环节？

像元坐标变换、像元灰度值重采样


遥感图像的几何校正

也称图像纠正，其目的是改正原始影像的几何变形，产生一幅符合某种地图投影或图形表达要求的新图像。


遥感图像的几何畸变的原因？
- 遥感器本身引起的畸变 全景投影变形
- 外部因素引起的畸变
  - 遥感平台位置和运动状态变化的影响
  - 地形起伏的影响
  - 地球表面曲率的影响
  - 大气折射的影响
  - 地球自转的影响

几何粗校正：针对引起畸变原因而进行的校正，这种畸变按照比较简单和相对固定的几何关系分布在图像中的，校正时只需将传感器原校准数据、遥感平台的位置以及卫星运行姿态等一系列测量数据代入理论校正公式即可。几何粗校正主要校正系统畸变。


几何精校正：是利用控制点进行的几何校正，它是用一种数学模型来近似描述遥感图像的几何畸变过程，并利用畸变的遥感图像与标准地图之间的一些对应点（即控制点（GCP））求得这个几何畸变模型，然后利用此模型进行几何畸变校正，这种校正不考虑畸变的具体形成原因，而只考虑如何利用畸变模型来校正遥感图像


## 5.3 图像增强与变换

目的：
- 提高图像的视觉效果，突出相关的专题信息，使分析者更容易地识别出图像内容。

$$
图像增强
\left\{
\begin{aligned}
&空间域
  \left\{
  \begin{aligned}
  &点运算
    \left\{
    \begin{aligned}
    &灰度变换
    \\&直方图修改法
      \left\{
      \begin{aligned}
      &均衡化
      \\&规定化
      \end{aligned}
      \right.
    \\&局部统计法
    \end{aligned}
    \right.
  \\&局部运算
    \left\{
    \begin{aligned}
    &图像平滑
    \\&图像锐化
    \end{aligned}
    \right.
  \end{aligned}
  \right.
\\&频率域
  \left\{
  \begin{aligned}
  &高通滤波
  \\&低通滤波
  \\&同态滤波增强
  \end{aligned}
  \right.
\\&彩色增强
  \left\{
  \begin{aligned}
  &假彩色增强
  \\&伪彩色增强
  \\&彩色变换及应用
  \end{aligned}
  \right.
\\&图像的代数运算
\end{aligned}
\right.
$$

### 对比度增强
对比度：图像中灰度反差的大小。对比度=最大亮度/最小亮度

低对比度的图像地物间对比性差，细节难以显现，地物目标难以辨认，因此需要进行对比度增强处理


1. 不同地物经常在可见光、近红外和中红外具有相似的辐射能量，当图像中具有相似辐射强度的地物比较集中时，会导致图像的低对比度。
2. 为记录地表各种物质的辐射能量，遥感器具有记录较大辐射能量（或亮度值）的能力，然而实际的遥感图像并不能充分利用遥感器的全部记录范围，遥感图像中记录的地物亮度值往往局限于比较小的亮度范围内，不能达到其全部亮度值范围，导致图像显示时的低对比度。

**灰度直方图**

以每个像元为单位，表示图像中各亮度值或亮度值区间像元出现的频率或数量的分布图。其中频率的计算式为$v_i=\frac{n_i}{n}$

`对比度增强`又称反差增强、灰度拉伸、灰度变换。它可使图像的亮度范围拉伸或压缩成指定的显示范围，从而突出图像像元之间的对比度，使图像变清晰，特征明显



**对比度增强方法**
+ 线性变换（线性拉伸）
  - 采用线性或分段线性的函数改善图像对比度
+ 非线性变换（非线性拉伸）
  - 对数变换和指数变换
  - 直方图均衡化
  - 直方图匹配（直方图规定化）

`直方图均衡化`是根据图像亮度值的出现频率来重新分配它们的亮度显示范围，使一定灰度范围内的像元的数量大致相等，得到一幅灰度直方图为均匀分布的新图像。其实质是对图像进行非线性变换。


直方图均衡化特点
+ 各灰度级所占图像的面积近似相等
+ 原图像上频率小的灰度级被合并
+ 增强图像上大面积地物与周围地物的反差，同时也增加图像的可视度
+ 具体增强效果不易控制，只能全局均衡

`直方图规定化`（直方图匹配）是指将一副图像的直方图变成指定形状的直方图，从而使原始图像进行增强处理的一种方法，亦属于*非线性变换*。

直方图的规定化对在不同时间获取的同一地区或邻接地区的图像，或者由于太阳高度角或大气影响引起差异的图像匹配很有用,特别是对图像镶嵌或变化检测有用。


### 波段间代数运算

**加法运算**、

图像相加可以把同一景物地多重影像加起来求平均，以便减少图像的随机噪音，也可以为某种增强效果的需要而把多幅图像有目的叠加在一起。



**差值运算**、

图像的减法运算，是指对同一景物在不同时间拍摄的图像或同一景物在不同波段的图像进行相减。

它可以用来消除影像中不希望的附加模式，可以改变背景的阴影模式、周期性噪音模式或在影像中每一个像元点上的附加混杂信息。

图像相减能用以指导动态监测、运动目标检测和跟踪及目标识别等工作

**比值运算**、

由两个波段对应像元的灰度值之比或几个波段组合的对应像元灰度值之比获得。

通过比值运算能压抑因地形坡度和方向引起的辐射量变化，消除地形起伏的影响。

也可以增强某些地物之间的反差，如植物、土壤、水在红色波段与红外波段图像上反射率是不同的，通过比值运算可以加以区分。

**植被指数**

差值植被指数 Difference Vegetation Index, DVI

$$DVI=NIR-R$$

比值植被指数 Ratio Vegetation Index ,RVI

$$RVI=\frac{NIR}{R}$$

归一化植被指数 Normalized Vegetation Index ,NDVI

$$NDVI=\frac{NIR-R}{NIR+R}$$

NDVI特点：
+ NDVI值在-1到1之间；
+ 制备区域一般在0.3-0.8之间，高值代表植被覆盖高；
+ 云、水体、雪一般为负值。


### 滤波

空间域滤波是改变空间频率的过程，以强调或抑制图像的特定特征。

空间频率是与图像纹理相关的概念，描述图像灰度值相对于邻域变化的方式。指图像色调变化的频率。

高频：灰度在小范围内变化很突然。
低频：区域平滑，几个像素内几乎没有灰度变化。


`空间域滤波`是在原图像上直接进行数据运算，对像素的灰度值进行处理。

`卷积`是一种用途很广的算法，可用卷积来完成各种处理变换。卷积滤波是对整个图像的像素按小块进行逐个处理的过程。

空间域滤波包括：
+ 平滑（低通）滤波器
  - 均值滤波
  - 加权平均模板法
  - 中值滤波
  - 
+ 锐化（高通）滤波器
  - 一阶微分：
    * Sobel算法
    * Roberts算法
    * Prewitt算法
  - 二阶微分
    * Laplacian算法
    * Wallis算法



`锐化`可使地物边界细节增强，不但提高图像的视觉效果，而且还便于对图像的形状特征更好地识别。

图像锐化的目的是加强图像中地物的细节边缘和轮廓。

锐化的作用是使灰度反差增强。

因为边缘和轮廓都位于灰度突变的地方。所以锐化算法的实现是基于微分作用。


### 彩色增强

***人的视觉只能分辨出单一波长对应的单色光***，如0.62-0.76微米波长的光感觉为红色，但不能分出混合色，如 0.7微米波长的红光与0.54微米波长的绿光按一定比例混合叠加后，人眼感觉为黄色


`彩色合成`就是利用眼睛的视觉特性，以少数几种色光或染料合成出许多不同的颜色。彩色合成一般是用`红、绿、蓝`三种基本色调，按一定比例混合而成五光十色但任何两种基色均不能混合成另一种基色。彩色合成方法有两种，一种是`加色法`，一种是`减色法`。


`真彩色合成`是在通过蓝、绿、红三原色的`滤光片`而拍摄的同一地物的三张图像上，若使用同样的三原色进行合成，可得到接近天然色的颜色，此方法称为真彩色合成


`假彩色合成`由于多波段摄影中，一副图像多不是三原色的波长范围内获得的，如采用人眼看不见的红外波段等，因此由这些图像所进行的彩色合成称假彩色合成。



### 图像变换

**IHS变换**

物理学上表示颜色体系的表色系统主要有两类，一类是根据实验把颜色作为生理物理量而定量处理的混色系统，简称RGB 系统或RGB 空间，另一类是使用记号、色谱等定性处理人所感知的颜色的表色系统，简称`IHS 系统`。

当需要`定量处理色彩`时，RGB 混色系统很方便，但如要对某地物目标的`彩色特性进行描述`，直接使用红、绿、蓝分量就很难实施，因为人眼不能直接测定RGB三色的比例，只能通过感知颜色的`亮度(I)、色调(H) 和饱和度(S)`来区分地物，所以IHS系统更容易理解

Hue 色调：对颜色的主观感知

Saturation 饱和度：颜色的纯净度

Intensity 亮度：颜色的明亮度


**主成分变换**

主成分变换，Principal Component Transform，PCT，主成分分析PCA，K-L变换。

目的：数据降维，将多个波段压缩维少数波段。

过程：对某一多光谱影像f，利用K-L变换矩阵A进程线性变换，产生一组新的多光谱影像g（主成分）。$g=Af$，f是变换前多光谱特征空间的像元矢量；g是变换后多光谱特征空间的像元矢量；A是一个线性变换矩阵。

变换后各分量是原始分量的信息的线性组合，综合了原有各分量的信息而不是简单地取舍，使g能够较好地反映事物的本质特征。



**缨帽变换**

Tasseled Cap，缨帽变换。$g=Af$。

对于Landsat MSS数据，缨帽变换对原始数据进行正交变化，转换到一个四维空间，包括土壤亮度指数SBI（或称红度，反映土壤反射率变化信息），“绿度”植被指数GVI，“黄度”指数YVI（植被的枯萎程度），以及域大气影响密切相关的Non-such指数NSI（主要是噪声）。

对Landsat 5 TM 数据，三个因子：亮度、绿度、第三分量（土壤特征及湿度）


**图像融合**

图像融合是采用某种算法将覆盖同一地区（或对象）、同一时期的两幅或多幅空间配准的影像融合生成满足某种要求的影像的技术。（如提高空间或光谱分辨率）

要求：
+ 同一个研究区、同一时期
+ 图像（高分辨率全色图像、低分辨率多光谱图像）经过配准
+ 融合全色图像的空间信息、多光谱图像的光谱信息产生新的图像

图像融合方法：
+ 乘法融合
+ Brovey变换融合
+ 主成分变换融合
+ IHS变换融合

















